<!doctype html>
<html lang="en">
    <head>
        <title>Dashboard</title>
        <!-- Required meta tags -->
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
        />

        <!-- Bootstrap CSS v5.2.1 -->
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
            crossorigin="anonymous"
        />
        <style>
    body {
        min-height: 100vh;
        background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
        font-family: "Segoe UI", system-ui, sans-serif;
    }

    .dashboard-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.25);
        padding: 20px;
    }

    .table thead th {
        vertical-align: middle;
        text-align: center;
    }

    .table tbody td {
        vertical-align: middle;
        text-align: center;
    }

    .nav-brand {
        font-weight: 600;
        letter-spacing: 0.5px;
    }

    .nav-link {
        font-weight: 500;
    }
</style>

    </head>

    <body>
        <header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4 p-3">
        <a class="navbar-brand nav-brand" href="/">
            Product Dashboard
        </a>

        <div class="ms-auto">
            <% if (!user) { %>
                <a href="/login" class="btn btn-outline-success btn-sm me-2">
                    Login
                </a>
            <% } else { %>
                <a href="/logout" class="btn btn-outline-danger btn-sm">
                    Logout
                </a>
            <% } %>
        </div>
    </nav>
</header>

        <main>

            <main class="container my-5">

    <div class="d-flex justify-content-end mb-3">
        <a class="btn btn-success" href="/add">Add Product</a>
    </div>

    <div class="dashboard-card">

            <table
                    class="table table-light table-bordered"
                >
                    <thead class="table-dark">
                        <tr>
                            <th scope="col">Name</th>
                            <th scope="col">Image</th>
                            <th scope="col">Price</th>
                            <th scope="col">Category</th>
                            <th scope="col">Added By</th>
                            <th scope="col">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% products.forEach((p) => { %>
                        <tr class="">
                            <td scope="row"><%= p.pname %></td>
                            <td><img
                                src="<%= p.pimg %>"
                                style="width: 250px; height: 160px; object-fit: cover;"
                                class="rounded"
                                alt=""
                            />
                            </td>
                            <td><%= p.price %></td>
                            <td><%= p.category %></td>
                            <td><%= p.staffName?.username || "N/A" %></td>
                            <td>
    <% if (user && user.role === "admin") { %>
        <div class="d-flex justify-content-center gap-2">
            <a href="/edit/<%= p.id %>" class="btn btn-sm btn-warning">
                Edit
            </a>

            <form
                action="/delete/<%= p.id %>?_method=delete"
                method="post"
                onsubmit="return confirm('are you sure you want to delete product ?')"
            >
                <button type="submit" class="btn btn-sm btn-danger">
                    Delete
                </button>
            </form>
        </div>
    <% } else { %>
        <span class="text-muted">â€”</span>
    <% } %>
    </td>

                        </tr>
                        <% }) %>
                    </tbody>
                </table>
    </div>
</main>

        </main>
        <footer>
            <!-- place footer here -->
        </footer>
        <!-- Bootstrap JavaScript Libraries -->
        <script
            src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            crossorigin="anonymous"
        ></script>

        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
            integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
            crossorigin="anonymous"
        ></script>
    </body>
</html>
